---
layout: post
title: PD実践：センサ演習４．カラーセンサの使い方
date: 
type: post
parent_id: '0'
published: false
password: ''
status: draft
categories:
- lecture
tags: []
meta:
  _edit_last: '2'
  views: '19'
  the_page_seo_title: ''
  the_page_meta_description: ''
  the_page_meta_keywords: ''
  the_page_noindex: '0'
  the_page_nofollow: '0'
  the_page_canonical_url: ''
  the_page_ads_novisible: '0'
  the_page_main_category: ''
  page_type: default
  the_page_read_time_novisible: '0'
  the_page_toc_novisible: '0'
  update_level: high
  the_review_enable: '0'
  the_review_type: Product
  the_review_name: ''
  the_review_rate: '5'
  redirect_url: ''
  the_page_no_amp: '0'
  _custom_css: ''
  _custom_js: ''
  the_page_memo: ''
  sns_image_url: ''
  the_page_no_archive: '0'
  the_page_no_rss: '0'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/"
---
<p>カラーセンサの使い方を学びます。</p>
<ul id="yui_3_17_2_1_1600123625928_97">
<li id="yui_3_17_2_1_1600123625928_96"><strong>API</strong>
<ul id="yui_3_17_2_1_1600123625928_95">
<li>ポート2のカラーセンサを初期化
<ul>
<li> ev3_sensor_config(EV3_PORT_2, COLOR_SENSOR);</li>
<li>ポート2がカラーセンサであることを設定</li>
</ul>
</li>
<li id="yui_3_17_2_1_1600123625928_94"> ポート2のカラーセンサから明度（環境光）を取得
<ul>
<li> uint8_t light = ev3_color_sensor_get_ambient(EV3_PORT_2);</li>
</ul>
</li>
<li> ポート2のカラーセンサから明度（反射光）を取得
<ul>
<li> uint8_t light = ev3_color_sensor_get_reflect(EV3_PORT_2);</li>
</ul>
</li>
<li>ポート2のカラーセンサからカラー情報を取得
<ul>
<li> colorid_t color = ev3_color_sensor_get_color(EV3_PORT_2);</li>
</ul>
</li>
</ul>
</li>
<li><strong>サンプルプログラム</strong>
<ul>
<li><a href="https://e-learn01.mars.kanazawa-it.ac.jp/moodle/pluginfile.php/43387/mod_page/content/13/app_light.c">/light/app.c</a>：カラーセンサーから取得した環境光と反射光の計測値をLCDに表示する。</li>
<li><a href="https://e-learn01.mars.kanazawa-it.ac.jp/moodle/pluginfile.php/43387/mod_page/content/13/app_color.c">/color/app.c</a>：カラーセンサーから取得したカラーの種類をLCDに表示する。
<ul>
<li>上のリンクをクリックするとソースコードが表示されますが、文字化けしないように文字コード等を変更しているので、このコードをコピペしたものはビルドで失敗します。あくまで表示用なので注意してください。</li>
</ul>
</li>
</ul>
</li>
<li><strong>演習４</strong>
<ol>
<li>カラーセンサーをEV3（ポート1）に接続した後、サンプルプログラム(/light/app.c)をEV3にアップロードし、動作を確認してください。</li>
<li> サンプルプログラムを改造し、以下の機能を実現してください。<br />
『カラーセンサー（環境光）の値が5以下になったら、「Finished!」を表示する。』</li>
<li><strong> [レポート１]</strong>下のカラーセンサー（環境光と反射光）の組立例を組み立ててください。フタが開いたら好きな曲が流れ、閉じたら止まるプログラムを作成しよう！<br />
ヒント：この演習では、割り込みやマルチタスクプログラミングは使いません。フタの開閉にすぐ反応するためには、１曲分のRingTone関数を続けて実行するのではなく、分割して実行したら、すぐ、カラーセンサーの値をチェックする必要があります。曲の周波数とテンポを２次元配列としてまとめるとスッキリしたプログラムになります。</p>
<ul>
<li>29_lightsensor.lxf：オープンセンサー<br />
<a href="http://demura.net/wordpress/wp-content/uploads/2018/09/29_lightsensor.png"><img class="img-responsive atto_image_button_text-bottom" role="presentation" src="{{ site.baseurl }}/assets/images/29_lightsensor.png" alt="" width="600" height="266" /><img src="{{ site.baseurl }}/assets/images/29_lightsensor-1024x454.png" sizes="(max-width: 800px) 100vw, 800px" srcset="http://demura.net/wordpress/wp-content/uploads/2018/09/29_lightsensor-1024x454.png 1024w, http://demura.net/wordpress/wp-content/uploads/2018/09/29_lightsensor-300x133.png 300w, http://demura.net/wordpress/wp-content/uploads/2018/09/29_lightsensor-768x341.png 768w, http://demura.net/wordpress/wp-content/uploads/2018/09/29_lightsensor.png 1366w" alt="" width="800" height="355" /></a></li>
</ul>
</li>
<li>カラーセンサーをEV3（ポート1）に接続した後、サンプルプログラム(/color/app.c)をEV3にアップロードし、動作を確認してください。</li>
</ol>
</li>
<li>参考
<ul>
<li><a href="http://www.toppers.jp/ev3pf/EV3RT_C_API_Reference/group__ev3sensor.html">各種センサに関するAPI (EV3RT C  API Reference)</a></li>
</ul>
</li>
</ul>
<p>終わり</p>
