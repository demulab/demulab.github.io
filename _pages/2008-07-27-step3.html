---
layout: page
title: 'STEP3: ODEをもっと知ろう'
date: 2008-07-27 17:49:45.000000000 +09:00
type: page
parent_id: '1286'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  _edit_last: '2'
  views: '3182'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robotsimu/step3"
---
<p>
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="320" height="260" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="flashvars" value="file=http://demura.net/archives/ode/robotsimu/aibo.flv&amp;image=http://demura.net/archives/images/ode/robotsimu/step3.jpg" /><param name="src" value="http://demura.net/flvplayer.swf" /><embed type="application/x-shockwave-flash" width="320" height="260" src="http://demura.net/flvplayer.swf" flashvars="file=http://demura.net/archives/ode/robotsimu/aibo.flv&amp;image=http://demura.net/archives/images/ode/robotsimu/step3.jpg"></embed></object></p>
<p>ODEを使って作成したAIBOシミュレータ．ODEに付属している3Dライブラリ（drawstuff）を使ってもこの程度のシミュレータを作れるというデモです．ODE本で勉強すればこの程度のものを作ることも不可能ではありません．実際に，数年前，卒研生と作ったものです．AIBOの著作権の関係で残念ながらソースコードは公開できません．</p>
<hr />
<p>ODE本「<a href="http://www.amazon.co.jp/gp/product/4627846916?ie=UTF8&amp;tag=demuranet-22&amp;linkCode=as2&amp;camp=247&amp;creative=1211&amp;creativeASIN=4627846916">簡単!実践!ロボットシミュレーション - Open Dynamics Engineによるロボットプログラミング</a><br />
 <img style="border: medium none  ! important; margin: 0px ! important" src="{{ site.baseurl }}/assets/images/2008/07/ir?t=demuranet-22&amp;l=as2&amp;o=9&amp;a=4627846916" alt="" width="1" height="1" /><br />
 」のStep3です．ここはODEの英文マニュアルを私流に書き直しています．100%ではありませんが，主要な部分を網羅していますので，英文マニュアルを読まなくてもプログラミングが可能です．APIについても90％以上掲載していますので，ODEのテストプログラムを読むときや，自分でプログラミングをするときも困らないと思います．詳しくはODE本で．．．</p>
<p>以下にStep3のソースコードを掲載します．zipで圧縮されているソースコードは<a href="http://demura.net/archives/2007/05/sourceCode.html">ここを参考にして</a>解凍・コンパイル・実行してください．それ以外のソースコードはプログラムの一部なので，そのままではコンパイルできません．</p>
<p>以下にStep3のシミュレータの動画を掲載します．ソースコードは<a href="../../dl">このページの注意事項を読み，ダウンロード，ビルドやコンパイルし実行してください．</a></p>
<ul>
<li><a href="#p31">プログラム3.1：　ODEのデータ型 (P60)</a></li>
<li><a href="#p32">プログラム3.2：　答え　(P69)</a></li>
<hr />
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="285" height="235" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="flashvars" value="file=http://demura.net/archives/ode/robotsimu/pro303.flv&amp;autostart=true" /><param name="src" value="http://demura.net/flvplayer.swf" /><embed type="application/x-shockwave-flash" width="285" height="235" src="http://demura.net/flvplayer.swf" flashvars="file=http://demura.net/archives/ode/robotsimu/pro303.flv&amp;autostart=true"></embed></object></p>
<p><br class="spacer_" /></p>
<li>プログラム3.3：　斜面をころがるボール　(P75)</li>
<li>説明：斜面をボールが転がり，あなたに向かっていきます．</li>
</ul>
<hr />
<p>
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="285" height="235" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="flashvars" value="file=http://demura.net/archives/ode/robotsimu/pro304.flv&amp;autostart=true" /><param name="src" value="http://demura.net/flvplayer.swf" /><embed type="application/x-shockwave-flash" width="285" height="235" src="http://demura.net/flvplayer.swf" flashvars="file=http://demura.net/archives/ode/robotsimu/pro304.flv&amp;autostart=true"></embed></object></p>
<li>プログラム3.4：　バニー　(P80)</li>
<ul>
<li>説明：ODEのテストプログラムtest_moving_trimesh.cppからバニーだけを取り出し，ソースコードもわかりやすいように変更しています．ここでは，ポリゴンの物体の扱い方を学びます．</li>
</ul>
<hr />
<p>
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="285" height="235" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="flashvars" value="file=http://demura.net/archives/ode/robotsimu/pro305.flv&amp;autostart=true" /><param name="src" value="http://demura.net/flvplayer.swf" /><embed type="application/x-shockwave-flash" width="285" height="235" src="http://demura.net/flvplayer.swf" flashvars="file=http://demura.net/archives/ode/robotsimu/pro305.flv&amp;autostart=true"></embed></object></p>
<li>プログラム3.5：　Aモータ　(P94)</li>
<ul>
<li>説明：ODEで最もエーモータのAモータの使い方のサンプルです．</li>
</ul>
<hr style="width: 100%; height: 2px;" />
<ul>
<li><span style="font-weight: bold">プログラム3.1：　ODEのデータ型 (P60)</span><a title="p31" name="p31"></a><br />
 #if defined(dSINGLE)     // dSINGLEが定義されていたら<br />
 typedef float dReal;　     // 　　　dRealはfloatとします．<br />
 #elif defined(dDOUBLE) // dDOUBLEが定義されていたら<br />
 typedef double dReal;　// 　　　dRealはdoubleとします．<br />
 #else　　　　　　　　         　// それ以外の場合<br />
 #error You must #define dSINGLE or dDOUBLE<br />
 #endif　　　　　　　　         // #ifの終わりtypedef dReal dVector3[4];　　  // dVector3はdRealの配列(要素4個）<br />
 typedef dReal dMatrix3[4*3];　// dMatrix3はdRealの配列(要素12個)</li>
<li><span style="font-weight: bold">プログラム3.2：　答え　(P69)</span><a title="p32" name="p32"></a><br />
 dBodyID body;<br />
 dMass mass;　　　　　　　　 　　　           // 質量パラメータ構造体<br />
 dReal r = 0.5, l = 1.0, m = 10.0;　   // 半径，長さ，質量<br />
 dReal x = 0.0, y = 0.0, z =  1.0;     // 位置の座標<br />
 dReal ax = 1, ay = 0, az = 0;         // 回転軸ベクトル<br />
 dReal angle = 45.0 * M_PI / 180.0;    // M_PIは円周率body   = dBodyCreate(world);　　　    // ボディの生成<br />
 dMassSetZero(&amp;mass);　　　　　　　　　// 質量パラメータの初期化<br />
 dMassSetCylinderTotal(&amp;mass,m,3,r,l); // 質量計算<br />
 dBodySetMass(body,&amp;mass);　　　　　  　 // 質量の設定<br />
 dBodySetPosition(body,x, y, z);　   　     // 位置の設定dMatrix3 R;<br />
 dRFromAxisAndAngle(R, ax, ay, az, angle);　// 回転行列の計算<br />
 dBodySetRotation(body,R);　　　　　　　　        　// 姿勢の設定</li>
</ul>
<hr />
（最終更新日　2008-7-27)</p>
