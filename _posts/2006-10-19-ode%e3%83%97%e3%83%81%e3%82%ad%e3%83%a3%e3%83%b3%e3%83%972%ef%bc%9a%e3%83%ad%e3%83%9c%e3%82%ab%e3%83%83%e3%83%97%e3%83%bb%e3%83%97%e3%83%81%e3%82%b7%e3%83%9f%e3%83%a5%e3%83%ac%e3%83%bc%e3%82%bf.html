---
layout: post
title: ODEプチキャンプ2：ロボカップ・プチシミュレータを作ろう！
date: 2006-10-19 18:30:13.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- ode
tags: []
meta:
  _edit_last: '2'
  views: '1008'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/9ode/331.html"
---
<p> <br />
<img src="{{ site.baseurl }}/assets/images/2006/10/title.jpg" alt=" " width="480" height="130" /></p>
<p> <br />
時が経つのは本当に早いもので，この間暑いと思っていたらもうすっかり秋ですね．１０月１６～１８日と妙高高原にある大学のセミナーハウスに研究室の学生と行き，まじめに輪講やテニスを楽しみました．山はもうすっかり紅葉が色づき美しかったのが印象的でした．</p>
<p>さて，Open Dynamics Engine プチキャンプもデビューしてから２ヶ月がすぎ，新しいロボコンマガジン（No.48）が１０月１４日（土）に発売されました．</p>
<p>今回は連載２回目となります．連載が全４回しかないのにも関わらず，グリーディ（greedy)にも最終回は２脚歩行ロボットのプチシミュレータを作ることを目標としているため，今回は車輪型ロボット，次回はロボットアームのプチシミュレータとドンドン作っていきます．</p>
<p>ロボコンマガジンでは紙面が限られているため詳しく説明できません．このページではそれを補うため，サンプルプログラムの全ソースコードと豪華付録？として連載に登場したAPI集を掲載しています．</p>
<ul>
<li><strong><span style="font-size: small;">君もサンプルプログラムをゲットしよう！</span></strong></li>
</ul>
<ul>
<li><a href="http://demura.net/archives/images/ode/camp2/pro1.lzh">プログラム１（自由落下：衝突検出なし）<br />
</a><a href="http://demura.net/archives/images/ode/camp2/pro1.lzh"><br />
<img src="{{ site.baseurl }}/assets/images/2006/10/fig3s.jpg" alt=" " /></p>
<p></a>ゆっくり落下していくと．．．<a href="http://demura.net/archives/images/ode/camp2/pro1.lzh"><br />
</a></li>
<li><a href="http://demura.net/archives/images/ode/camp2/pro2.lzh">プログラム2（自由落下：衝突検出あり）<br />
</a><a href="http://demura.net/archives/images/ode/camp2/pro2.lzh"><br />
<img src="{{ site.baseurl }}/assets/images/2006/10/pro2_s.jpg" alt=" " /></p>
<p></a>地面に着陸<a href="http://demura.net/archives/images/ode/camp2/pro2.lzh"><br />
</a></li>
<li><a href="http://demura.net/archives/images/ode/camp2/pro3-061128.lzh">プログラム3（プチシミュレータ）<br />
</a><a href="http://demura.net/archives/images/ode/camp2/pro3.lzh"><br />
<img title="Open Dynamics Engine  Robot Simulation" src="{{ site.baseurl }}/assets/images/2006/10/shoot_s.jpg" alt=" Open Dynamics Engine    Robot Simulation" width="180" height="120" /></p>
<p></a>ロングシュート！<a href="http://demura.net/archives/images/ode/camp2/pro3.lzh"><br />
</a></li>
<li>注1：これらのプログラムはODE教育用のサンプルプログラムとして書いたもので，ロボコンマガジンの記事で説明している全サンプルプログラムです．上のプログラムを自由にダウンロードして遊んでください．これらのプログラムは無保証です．なお，再配布及び無断転載等はお止めください．</li>
<li>注2：mingw, linux, cygwin. OS Xに対応しています．ご自分の環境のmakefile（例えばmakefile.linux）をmakefileにコピーしてからmakeしてください．なお，オリジナルのmakefileはmingw用になっていますのでmingwを利用されている方はコピーする必要はありません．</li>
</ul>
<li><strong><span style="font-size: small;">makeに失敗する方へ<br />
</span></strong></li>
<ul>
<li>makeを実行したとき[cannot found -lode]などとコンピュータに怒られた方はodeのライブラリが所定の位置にインストールされていません。mingwやcygwinターミナルを開き以下のコマンドを実行してください。</li>
</ul>
<ul>
<li>cd   /home/ユーザ名/src/ode-0.6</li>
<li>make   install</li>
</ul>
<p>また，連載を読んでよくわからない方は是非このページで質問してください．感想やご意見等も大歓迎です．</p>
<p><!--more--></p>
<p><img title="ロボットシミュレータ　シミュレーション　Robot Simulation Open Dynamics Engine" src="{{ site.baseurl }}/assets/images/2006/10/field640.jpg" alt=" Open Dynamics Engine   Robot Simulation" width="640" height="454" /></p>
<p><span style="font-size: x-small;">今回の目玉は上にあるロボカップ中型ロボットリーグのプチシミュレータです．画面の中央より少し左に見える赤い物体はボールで，中央にある黒い物体はロボットで，Fu Fightersのロングシュートをシミュレートしています．遊び方やダウンロードの方法はロボコンマガジンNo.48の記事を読んでください．</span></p>
<ul>
<li><strong><span style="font-size: small;">サンプルプログラム</span></strong></li>
</ul>
<ul>
<li><a href="http://demura.net/archives/images/ode/camp2/pro1.lzh">プログラム１</a></li>
<li><a href="http://demura.net/archives/images/ode/camp2/pro2.lzh">プログラム2</a></li>
<li><a href="http://demura.net/archives/images/ode/camp2/pro3-061128.lzh">プログラム3<br />
</a>実行開始時の設定ではカメラを遠方に設定しているためロボット等がよく見えません．<br />
ウインドウの隅をドラッグしてウインドウを大きくするか，マウスボタン（左，右）を押しなら画面をドラッグすると視線，大きさなどを変更できます．</li>
</ul>
<li><strong><span style="font-size: small;">makeに失敗する方へ<br />
</span></strong></li>
<ul>
<li>makeを実行したとき[-lode cannot found]などと怒られた方はodeのライブラリが所定の位置にインストールされていません。mingwやcygwinターミナルを開き以下のコマンドを実行してください。</li>
</ul>
<ul>
<li>cd   /home/ユーザ名/src/ode-0.6</li>
</ul>
<ul>
<li>make   install<br />
<a href="http://demura.net/archives/images/ode/camp2/pro3.lzh"> </p>
<p></a></li>
</ul>
<li><strong><span style="font-size: small;">豪華付録？API集</span></strong></li>
<ul>
<li>dBodyID dBodyCreate(dWorldID world)<br />
剛体を作り、そのID番号を戻り値として返す</li>
<li>const dReal *dBodyGetPosition(dBodyID body)<br />
剛体bodyの重心位置を取得しそのポインタを返す</li>
<li> const dReal *dBodyGetRotation(dBodyID body)<br />
回転行列を取得しそのポインタを返す</li>
<li>void dBodySetMass(dBodyID body, const dMass *mass)<br />
剛体bodyに質量パラメータmassを設定する</li>
<li>void dBodySetPosition(dBodyID body, dReal x, dReal y, dReal z)<br />
剛体bodyの重心を絶対座標系(x,y,z)の位置に設定する</li>
<li>void dBodySetRotation(dBodyID body, const dMatrix3 R)<br />
剛体bodyを回転行列Rで表す姿勢に設定する</li>
<li>dGeomID dCreateBox(dSpaceID space, dReal lx, dReal ly, dReal lz)<br />
spaceに各辺の長さ(lx,ly,lz)の直方体ジオメトリを生成する</li>
<li>dGeomID dCreateCylinder(dSpaceID space, dReal r, dReal l)<br />
半径r、長さlの円柱ジオメトリを生成し、そのID番号を返す</li>
<li> dGeomID dCreatePlane(dSpaceID space ,dReal a, dReal b, dReal c, dReal d)<br />
spaceにax+by+cz=dの平面ジオメトリを生成する</li>
<li>void dGeomSetBody(dGeomID geom, dBodyID body)<br />
物体の2つの属性であるジオメトリgeomと剛体bodyを関連づける</li>
<li>dSpaceID dHashSpaceCreate(0)<br />
衝突計算用スペースを生成し、そのID番号を返す</li>
<li>void dJointGroupEmpty(dJointGroupID)<br />
接触点が格納されているジョイントグループを空にする</li>
<li> void dJointAttach(dJointID joint, dBodyID body1, dBodyID dBody2)<br />
剛体body1とbody2にジョイントjointを取り付ける</li>
<li> dJointGroupID dJointGroupCreate(0)<br />
接触点のグループを格納するジョイントグループを生成し、そのID番号を返す</li>
<li> void dJointSetHingeAnchor(dJointID joint, dReal x, dReal y, dReal z)<br />
ヒンジジョイントの回転軸の中心点(x,y,z)を設定する</li>
<li> void dJointSetHingeAxis(dJointID joint, dReal x, dReal y, dReal z)<br />
ヒンジジョイントの回転軸ベクトル(x,y,z)を設定する</li>
<li>void dMassSetBoxTotal(dMass *mass, dReal m, dReal lx, dReal ly, dReal lz)<br />
サイズ(lx,ly,lz)、全質mの直方体の質量パラメータmassを計算する</li>
<li>void dMassSetCylinderTotal(dMass *mass, dReal m, int dir, dReal r, dReal l)<br />
方向dir(1=x,2=y,3=z）、半径r、長さl、全質量mの円柱の質量パラメータmassを計算する</li>
<li> void dMassSetZero(dMass *mass)<br />
質量パラメータmassの要素を0に初期化する</li>
<li>void dRFromAxisAndAngle(dMatrix3 R, dReal ax, dReal ay, dReal az, dReal angle)軸ベクトル(ax,ay,az)周りにangle[rad]回転させた時の回転行列Rを求める</li>
<li> void dSpaceCollide(dSpaceID space, void *data, dNearCallback *callback)<br />
spaceで衝突する可能性のある2つのジオメトリを選び出し、引数のcallback関数を呼び出す。dataはcallback関数へ渡すデータへのポインタ</li>
<li>dWorldID dWorldCreate()<br />
物理計算用ワールドを生成し、そのID(識別)番号を戻り値として返す</li>
<li>void dWorldDestroy(dWorldID world)<br />
物理計算用ワールドworldを破壊する</li>
<li>void dWorldSetGravity(dWorldID world, dReal x, dReal y, dReal z)<br />
ワールドworldに(x,y,z)[m/s2]の重力加速度を設定する</li>
<li>void dWorldStep(dWorldID world, dReal step_size)<br />
ワールドworldのシミュレーションを1ステップ進める。2番目の引数step_sizeは積分のステップ時間[s]</li>
<li> void dsDrawBoxD(const double pos[3], const double R[12], const double sides[3])位置posに回転行列Rを取るサイズsidesの直方体を描画する</li>
<li>void dsSetViewPoint(float xyz[3], float hpr[3])<br />
視点xyzと視線hpr[°]を設定する</li>
<li>void dsSimulationLoop(int argc, char **argv,int w, int h, dsfunction *fn)<br />
シミュレーションループを呼び出す。1、2番目の引数はmain関数の引数で、3,4番目は描画ウインドウの大きさ(横w,縦h)で、5番目の引数は描画関数クラス</li>
</ul>
