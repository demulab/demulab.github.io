---
layout: post
title: シミュレータで学ぶＣ言語 [分岐]
date: 2011-05-06 06:47:38.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- ode
tags: []
meta:
  _edit_last: '2'
  views: '1648'
  _wp_old_slug: ''
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/9ode/8706.html"
---
<p>今回はプログラムの分岐処理をするためのif文とswitch文を学ぶ．ここではif文とswitch文そのものの説明は省略し，サンプルプログラムを紹介する．</p>
<p>サンプルプログラムweek4-1はif文の例．キーボードからモータのパワーを入力し，ロボットを走行させるプログラム．<br />
このシミュレータではユーザのプログラムはuser_main関数の中に記述する．この関数はループの中にあり，繰り返し呼ばれており，ループが回る度に２５行目で１ずつ増加している．</p>
<p>9行目はループの度に聞かれるとロボットが前進しないので，500回毎にパワーを聞き，その間ロボットを走行させるための処理．12行目で標準入力（キーボード）からパワーを入力し，int型の変数powerに代入する．ここで，powerの前のアドレス演算子&amp;をつけることを忘れないように．理由はポインタを学ぶときに説明する．</p>
<p>ロボットのパワーは-100から100までなので，15行目のif文でその範囲のパワーだけでロボットを動かし，それ以外は間違いの表示をプログラムをexit(1)で終了する．</p>
<p><strong>Week4-1</strong></p>
<pre class="brush:cpp;">// week4-1
int count = 0; // 繰り返し回数
// user_main()関数はループの中にあり，繰り返し呼ばれている
void user_main()
{
    int power; // モータのパワー

    // ループの度に聞かれるのがうざいから500回毎にパワーを聞く
    if (!(count % 500))
    {
        printf("Input power:");
        scanf("%d", &amp;power);

        // パワーは-100以上100以下の決まり
        if ((-100 &#60;= power) &amp;&amp; (power &#60;= 100))
        {
            motor(power, power); // モータへの命令
        }
        else
        {
            printf("パワーは-100以上100以下を入力せよ\n"); // 時計周り
            exit(1);  // プログラム終了
        }
    }
    count++;
    printf("count=%d \r",count); // \rは復帰（カ―ソルが先頭行へ戻る);
}</pre>
<ul>
<li><strong>タスク4-1</strong>
<ul>
<li><a href="http://demura.net/wordpress/wp-content/uploads/2011/05/week4-1.zip">week4-1.zipをここからダウンロードし</a>，c:\ode-0.11.1\myprogの中に解凍し，ビルド・実行せよ．</li>
<li>このサンプルプログラムでは左右のモータに同じパワーを入力したが，左右別々のパワーを入力できるように変更せよ．</li>
</ul>
</li>
</ul>
<p><strong>Week4-2</strong></p>
<p>次のサンプルプログラムweek4-2はロボットシミュレータのロボットは動かさず，文字だけを表示する簡単なもの．標準入力から信号機の色に対応する数字，０：赤，１：黄，２：青を入力し，それに応じた文字を表示する．８行目はループの1回目だけの処理．ただし，変数countは常に０なので，ifの中の処理がずっと繰り返される．</p>
<p>この例では分岐処理として，if else文を使っている．複数分岐がある場合は１６，１８行目のようにelse if を左に揃えるのが流儀．</p>
<pre class="brush:cpp;">//  week4-2
// user_main()関数はループの中にあり，繰り返し呼ばれている
void user_main()
{
    int power; // モータのパワー

    // ループの1回目だけの処理．ただし，変数countは常に０なので，ifの中の処理がずっと繰り返される．
    if (count == 0)
    {
        int	signal;
        printf("Input Signal Color\n Red 0, Yellow 1, Blue 2:");
        scanf("%d",&amp;signal);

        if (signal ==0)
            printf("止まる\n");
        else if (signal == 1)
            printf("注意して渡る\n");
        else if (signal == 2)
            printf("渡る\n");
        else
            printf("そんな色ありません\n");
    }
}</pre>
<ul>
<li><strong>タスク4-2</strong>
<ul>
<li> <a href="http://demura.net/wordpress/wp-content/uploads/2011/05/week4-2.zip">week4-2.ziｐをここからダウンロードし</a>，c:\ode-0.11.1\myprogの中に解凍し，ビルド・実行せよ．</li>
<li>サンプルプログラムweek4-2をswitch文で書き換えよ．</li>
</ul>
</li>
</ul>
<p>以上</p>
