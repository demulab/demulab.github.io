---
layout: post
title: シミュレータで学ぶC言語[繰り返し]
date: 2011-05-19 16:43:26.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- ode
tags: []
meta:
  _edit_last: '2'
  views: '4046'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/9ode/8766.html"
---
<p>[caption id="attachment_4103" align="alignnone" width="534" caption="ピラミッド：ホームワーク６の答え"]<a href="http://demura.net/wordpress/wp-content/uploads/2009/06/pyramid1.jpg"><img src="{{ site.baseurl }}/assets/images/2011/05/pyramid1.jpg" alt="ピラミッド：ホームワークの答え" title="pyramid1" width="534" height="364" /></a>[/caption]</p>
<p>C言語の繰り返しにはfor文, while文，do while文がありましたね．ここではfor文を使い，図のようなピラミッドを作ってみましょう．<br />
まず、球と直方体の表示方法を学びます。</p>
<p>球の表示方法</p>
<pre class="brush:cpp">#include "dm.h"
#include "stdio.h"

double x = 0.0, y = 0.0, z = 1.0; // 重心位置　&#91;m&#93;
double r = 0.2;                   // 半径 &#91;m&#93;

void command(int cmd)
{
    switch (cmd) {
        case 'z':   z += 0.1;  break; //　zキーを押すと zの値が0.1ずつ増加する
        default:     printf("Input z key \n");
    }
}

void simLoop(int pause)        /***  シミュレーションループ　***/
{
    dmDrawSphere(x,y-1,z,r); // 球の描画
}

int main()         /*** main関数 ***/
{
    dmInit();   // ODEの初期化
    dmLoop(800, 600, simLoop, command);  // シミュレーションループ ウインドウの幅，高
    dmClose();  // ODEの終了
    return 0;
}</pre>
<p>&nbsp;</p>
<p>main()関数のdmInit()はシミュレータの初期化です。dmLoop()がシミュレーションで繰り返し実行される関数です。この関数は引数を４つとり、１、２番目はウインドウの横、縦のサイズ[ピクセル]、３番目はdmLoopの中で使用するsimLoop関数、４番目はキーボード処理に使用するcommand関数です。関数も関数の引数になることができます。ちなみに、関数名はその関数のメモリ上でのアドレスとなります。dmClose()でシミュレータの終了処理をします。</p>
<p>simLoop関数はこのソースコードではわかりませんが、whileループの中に入っており、シミュレーションループ毎呼び出されます。 dmDrawSphere(x,y-1,z,r)が球を描画する関数です。引数は、４つあり、始めの３つは重心の位置x, y, z座標成分、最後は球の半径となっています。</p>
<p>command関数はキーの入力処理をしています。zキーが押される度に、zの値が0.1ずつ増加します。これは球のｚ座標なので押す度に球が上昇します。プログラムを事項して確認してください。</p>
<ul>
<li><strong>演習1</strong>
<ul>
<li>このプログラム <a href="http://demura.net/wordpress/wp-content/uploads/2011/05/week6-1.zip">week6-1.zip</a>をc:\ode-0.11.1\myprogにダウンロード、解凍、ビルドして実行してください。</li>
<li>直方体を(0, -1, 1)の位置に表示させるプログラムを書きなさい。なお、直方体を表示させる関数は次です。
<ul>
<li>dmDrawBox(double x,  double y, double z,  double sx, double sy, double sz);</li>
<li>ここで、x, y ,zは重心の位置、sx, sy, szは直方体の各軸成分の長さ。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><!--more--></p>
<pre class="brush:cpp">// 直方体を一列に並べるプログラム
#include "dm.h"
#include "stdio.h"

double x = 0.0, y = 0.0, z = 0.05;   // 位置(x,y,z)&#91;m&#93;
double sx = 0.1, sy = 0.1, sz = 0.1; // 直方体のサイズ(x, y, z)&#91;m&#93;

void simLoop(int pause)        /***  シミュレーションループ　***/
{
    int i, num = 11;             // 直方体の数
    dsSetColor(1.0, 0.0, 0.0);   // 赤色の設定(赤，緑，青）
    for (i = 0; i &#60; num; i++)
    {
        y = i * 0.2;          // 直方体重心のy軸成分
        dmDrawBox(x,y,z,sx,sy,sz); // 直方体の表示        　
    }
}</pre>
<p>11行目のdsSetColor()は色を設定する関数です．引数は光の3原色の値を3個取り，１番目は赤，２番目は緑，３番目は青成分で0以上1以下の値となります．ちなみに，全部0だと黒，全部1.0だと白です．<br />
12から16行目がfor文です．繰り返し回数はnum回，ここでは10行目でnumが11になっているので，11回ループが回ることになります．14行目でループ毎に直方体のy軸成分の位置を変化させています。ここで、x座標は地面の中央マーカーから赤マーカーの方向，y座標は中央マーカーから青マーカーの方向，z座標は中央マーカーから上空方向になります．<br />
15行目は直方体の描画です．</p>
<p>これで今回は終わりです．タスクは少しハードです。難しいものもあるので必ずしも全部やる必要はありません.</p>
<p><strong>演習２： </strong><a href="http://demura.net/wordpress/wp-content/uploads/2011/05/week6-2.zip">week6-2.zip</a>をダウンロードして実行しよう．</p>
<p><strong>タスク6</strong>：</p>
<ol>
<li>赤い直方体（この例では立方体）の色を青に変えよう．
<ul>
<li>dsSetColor(float r, float g, float b)<br />
r, g, bは光の３原色の赤、緑、青成分。値は0以上１以下のfloat型。例えば、緑にしたかったらrとbは0.0、gには１.0を代入する。</li>
</ul>
</li>
<li>赤い直方体の位置を左にずらし，中央の直方体が原点に来るようにしましょう．</li>
<li>上の問題で，一番左にある直方体の色を白にし、それから右（y軸正方向）へ向かうにつれ徐々に赤に変化させよう．</li>
<li>forループを２重にし，ｘ軸方向にも直方体を描画し，合計121個の直方体を表示しよう．</li>
<li>forループを３重にし、z軸方向（上空方向）にも直方体を10段（合計11段）描画し、大きな立方体を表示しよう。</li>
<li>forループを３重にし，z軸方向にも直方体を描画し，直方体の間隔も調整して上図のようなピラミッドを作ろう．</li>
<li>白い直方体（サイズは上の直方体と同じ）を半径2mの円周上に６度ずつ60個並べよ。</li>
<li>上を時計と考えて、シミュレーションのループが進むたびに、白い直方体が一つだけ時計周りに順番に変化するプログラムを作りなさい。</li>
<li>らせん階段状に直方体（サイズは任意）を100個並べなさい</li>
<li>100段の<a href="http://ja.wikipedia.org/wiki/%E3%83%88%E3%83%A9%E3%83%B3%E3%83%97%E3%82%BF%E3%83%AF%E3%83%BC">トランプタワー</a>を作りなさい。直方体のサイズは実際のトランプと同じにすること。
<ul>
<li>ヒント：<a href="http://demura.net/wordpress/wp-content/uploads/2011/05/week6-3.zip">week6-3.zip</a>のソースコードを読み実行する。</li>
</ul>
</li>
</ol>
<p>&nbsp;</p>
<p style="text-align: right;">でむ</p>
