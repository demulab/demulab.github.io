---
layout: post
title: ROS Indigo作業メモ
date: 2015-06-30 10:44:49.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- robocup
tags: []
meta:
  _edit_last: '2'
  views: '5165'
  _oembed_f11a2186f7e4617d86e80f8d9239aa99: "{{unknown}}"
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/robocup/11477.html"
---
<p style="text-align: justify;">Ubuntu14.04にROS Indigoを入れてTurtlebot2を動かすまでの簡単な作業メモ。</p>
<ul>
<ul>
<li style="text-align: justify;">ROSインストール：<a href="http://wiki.ros.org/indigo/Installation/Ubuntu">http://wiki.ros.org/indigo/Installation/Ubuntu</a>のとおり、Desktop-Fullをインストールする。</li>
<li style="text-align: justify;">Turtlebotパッケージのインストール：<a href="http://wiki.ros.org/turtlebot/Tutorials/indigo/Turtlebot%20Installation">http://wiki.ros.org/turtlebot/Tutorials/indigo/Turtlebot%20Installation</a>ではホームディレクトリにrocon、kobuki、turtlebotの３つのディレクトリを作るが、ホームディレクトリの構成をシンプルにしたいので~/turtlebotの下にインストールする。それ以外は同じ。ここでは，ソースコードを読みたいのでソースからインストールする。
<ul>
<li style="text-align: justify;">4.1 Preparation （準備）
<ul>
<li style="text-align: justify;"><code>$ sudo apt-get install python-rosdep python-wstool ros-indigo-ros</code></li>
<li style="text-align: justify;"><code>$ sudo rosdep init</code></li>
<li style="text-align: justify;"><code>$ rosdep update</code></li>
</ul>
</li>
<li style="text-align: justify;">4.2 Workspaces (ワークスペース）：~/turtlebotの下に３つのディレクトリを作成
<ul>
<li style="text-align: justify;"><code>$ mkdir -p ~/turtlebot/rocon</code></li>
<li style="text-align: justify;"><code>$ cd ~/turtlebot/rocon</code></li>
<li style="text-align: justify;"><code>$ wstool init -j5 src https://raw.github.com/robotics-in-concert/rocon/indigo/rocon.rosinstall</code></li>
<li style="text-align: justify;"><code>$ source /opt/ros/indigo/setup.bash</code></li>
<li style="text-align: justify;"><code>$ rosdep install --from-paths src -i -y</code></li>
<li style="text-align: justify;"><code>$ catkin_make</code></li>
<li style="text-align: justify;"><code>$ mkdir -p ~/turtlebot/kobuki</code></li>
<li style="text-align: justify;"><code>$ cd ~/turtlebot/kobuki</code></li>
<li style="text-align: justify;"><code>$ wstool init src -j5 https://raw.github.com/yujinrobot/yujin_tools/master/rosinstalls/indigo/kobuki.rosinstall</code></li>
<li style="text-align: justify;"><code>$ source ~/turtlebot/rocon/devel/setup.bash</code></li>
<li style="text-align: justify;"><code>$ rosdep install --from-paths src -i -y</code></li>
<li style="text-align: justify;"><code>$ catkin_make</code></li>
<li style="text-align: justify;"><code>$ mkdir -p ~/turtlebot/turtlebot</code></li>
<li style="text-align: justify;"><code>$ cd ~/turtlebot/turtlebot</code></li>
<li style="text-align: justify;"><code>$ wstool init src -j5 https://raw.github.com/yujinrobot/yujin_tools/master/rosinstalls/indigo/turtlebot.rosinstall</code></li>
<li style="text-align: justify;"><code>$ source ~/turtlebot/kobuki/devel/setup.bash</code></li>
<li style="text-align: justify;"><code>$ rosdep install --from-paths src -i -y</code></li>
<li style="text-align: justify;"><code>$ catkin_make</code></li>
<li style="text-align: justify;"><code>$ source ~/turtlebot/turtlebot/devel/setup.bash</code></li>
<li style="text-align: justify;"><code>$ rosrun kobuki_ftdi create_udev_rules</code></li>
</ul>
</li>
<li style="text-align: justify;">4.3 Convinience (利便性)
<ul>
<li style="text-align: justify;"><code>echo "source ~/turtlebot/turtlebot/devel/setup.bash" &gt;&gt; ~/.bashrc</code></li>
</ul>
</li>
</ul>
</li>
<li style="text-align: justify;">Hokuyo Lidar設定:<br />
TurtlebotパッケージではHokuyo Lidar (UTM-30LX)の設定がないので追加する。<br />
~/turtlebot/turtlebot/src/turtlebot/turtlebot_description/urdf/turtlebot_library.urdf.xacroに以下のコードを一番下の&lt;/robot&gt;の上に追加する。</p>
<pre class="brush:cpp;">&#60;!-- Urg Lidar --&#62;
  &#60;joint name="laser" type="fixed"&#62;
    &#60;origin xyz="0.13 0.00 0.1" rpy="0 0 0" /&#62;
    &#60;parent link="base_link" /&#62;
    &#60;child link="base_laser_link" /&#62;
  &#60;/joint&#62;

  &#60;link name="base_laser_link"&#62;
    &#60;visual&#62;
      &#60;geometry&#62;
        &#60;box size="0.06 0.06 0.07" /&#62;
      &#60;/geometry&#62;
      &#60;material name="Black" /&#62;
    &#60;/visual&#62;
    &#60;inertial&#62;
      &#60;mass value="0.000001" /&#62;
      &#60;origin xyz="0 0 0" /&#62;
      &#60;inertia ixx="0.0001" ixy="0.0" ixz="0.0"
        iyy="0.0001" iyz="0.0"
        izz="0.0001" /&#62;
    &#60;/inertial&#62;
  &#60;/link&#62;</pre>
</li>
<li style="text-align: justify;"> ~/turtlebot/turtlebot/src/turtlebot/turtlebot_bringup/launch/3dsensor.launchの次の部分を変更する。<br />
変更前：</p>
<pre class="brush:cpp;"> &#60;arg name="scan_topic" default="scan"/&#62;</pre>
<p>変更後:</p>
<pre class="brush:cpp;"> &#60;arg name="scan_topic" default="kinect_scan"/&#62;
 &#60;node name="laser_driver" pkg="urg_node" type="urg_node"&#62; &#60;param name="frame_id" value="base_laser_link" /&#62;&#60;/node&#62;</pre>
</li>
<li style="text-align: justify;">/opt/ros/indigo/share/turtlebot_navigation/param/cosmap_common_params.yamlの31行目のmin_obstacle_heightを0.05,32行目のmax_obstacle_heightを1.2に変更する．Hokuyo Lidarを低い位置に取り付けるため．この設定をしないと障害物回避をしないので悩むことになる．この設定では高さ0.05[m]以上1.2[m]以下の障害物を回避する。それ以外は回避しない。ロボットの高さやセンサの取り付け位置でこの値を変更する。
<pre class="brush:cpp;"> 
 scan:
    data_type: LaserScan
    topic: scan
    marking: true
    clearing: true
    min_obstacle_height: 0.05
    max_obstacle_height: 1.2
</pre>
</li>
</ul>
<li>urg nodeをインストールする。
<ul>
<li>sudo apt-get install ros-indigo-urg-node</li>
</ul>
</li>
<li>OpenCV2.4.9のインストール: 以下のサイトの手順に従った。
<ul>
<li><a href="http://www.samontab.com/web/2014/06/installing-opencv-2-4-9-in-ubuntu-14-04-lts/">Installing OpenCV 2.4.9 in Ubuntu 14.04 LTS</a></li>
</ul>
</li>
<li>doxygenのインストール
<ul>
<li>$ sudo apt-get install doxygen  doxygen-gui</li>
</ul>
</li>
<li><a href="http://www.rt-shop.jp/blog/archives/3372">RTのlibkobuki1.0.3をここからダウンロード</a>しインストール。
<ul>
<li>$ unzip libkobuki-1.0.3.zip</li>
<li>$ cd libkobuki-1.0.3</li>
<li>$ unzip libkobuki-1.0.3src.zip</li>
<li>$ ./BuildAll.sh
<ul>
<li>私の環境では改行コードの関係でエラーがでたので以下のコマンドでLinux用に修正する。</li>
<li>$ sed -i 's/\r//'  BuildAll.sh</li>
<li>$ ./BuildAll.sh</li>
</ul>
</li>
</ul>
</li>
<li>Julius4.3.1を<a href="http://julius.sourceforge.jp/index.php?q=documents.html#install">ここからダウンロード</a>しThe juliusbook第２章に従いソースからインストール。</li>
<li>Sirius-1.0.1(437MB)を<a href="http://sirius.clarity-lab.org/index.html%3Fp=13.html">ここからダウンロード</a>し，~/srcの中にコピーする．wiki_indri_index.tar.gz(11GB)も合わせてダウンロード．
<ul>
<li>cd ~/src</li>
<li>tar xvzf  sirius-1.0.1.tar.gz</li>
<li>mv sirius-1.0.1 sirius</li>
<li>cd ~/src/sirius/sirius-application</li>
<li>tar xvzf  question-answer.tar.gz</li>
<li>sudo  ./get-dependencies.sh</li>
<li>./get-kaldi.sh</li>
<li>./compile-sirius-server.sh</li>
</ul>
</li>
<li>Hydroで動いていたプログラムがIndigoでも動いたので終わり。</li>
</ul>
<p>&nbsp;</p>
