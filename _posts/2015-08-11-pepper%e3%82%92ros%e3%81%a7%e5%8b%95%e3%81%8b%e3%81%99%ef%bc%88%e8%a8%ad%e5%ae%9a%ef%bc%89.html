---
layout: post
title: PepperをROSで動かす：設定とRVIZ
date: 2015-08-11 09:27:18.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- robocup
tags: []
meta:
  _edit_last: '2'
  _oembed_d40f62ad47974433065b5145e97a9dde: "{{unknown}}"
  views: '4459'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/robocup/12002.html"
---
<p><span style="color: #ff0000;">2015年の記事なので情報が古いと思います。</span></p>
<p>SoftbankのPepperをROSで動かしたときのメモ。以下のサイトの手順に従い、Qiitaの記事も参考にしたが、私の環境ではそのままでは動かない部分もあった。環境はUbuntu14.04とROS Indigo。</p>
<ul>
<li><a href="http://wiki.ros.org/pepper/Tutorials">pepper/tutorials</a></li>
<li><a href="http://qiita.com/yoneken/items/10341448e1a1f5ba1c5c">PepperをROSと接続する</a></li>
</ul>
<p>1. Aldebaranのウェブサイトから必要なソフトウェアを~/naoqiにダウンロードする。</p>
<ul>
<li><a class="link_simple colorbox-load init-colorbox-load-processed cboxElement" href="https://community.aldebaran.com/ja/dl/ZmllbGRfY29sbGVjdGlvbl9pdGVtLTEwMjEtZmllbGRfc29mdF9kbF9leHRlcm5hbF9saW5rLTAtYmQ1ZDNl?width=500&amp;height=auto" target="_self" data-cbox-id="5603">Choregraphe 2.3.1 Linux 64 Setup</a></li>
<li><a href="https://community.aldebaran.com/ja/resources/software">Python 2.7 SDK 2.3.1 Linux 64</a></li>
</ul>
<p>2. ダウンロードしたファイルを展開する</p>
<ul>
<li>tar xvzf  pynaoqi-python-2.7-2.3.1.25-linux64.tar.gz</li>
<li>.bashrcの最後に一行を追加する<br />
export PYTHONPATH=${PYTHONPATH}:~/naoqi/pynaoqi-python2.7-2.3.1.25-linux64</li>
</ul>
<p>３． 必要なROSパッケージをインストールする。</p>
<p>sudo apt-get install ros-indigo-driver-base ros-indigo-move-base-msgs ros-indigo-octomap ros-indigo-octomap-msgs ros-indigo-humanoid-msgs ros-indigo-humanoid-nav-msgs ros-indigo-camera-info-manager ros-indigo-camera-info-manager-py</p>
<p>ROS tutorialには以下のコマンドで必要なパッケージをインストールするよう書いてあるが、私の環境では依存関係でインストールできなかった。</p>
<ul>
<li>sudo apt-get install ros-indigo-pepper-.*</li>
</ul>
<p>そのため、以下のコマンドで個別にインストールした。</p>
<ul>
<li>sudo apt-get install ros-indigo-pepper-robot ros-indigo-pepper-meshes ros-indigo-pepper-description ros-indigo-pepper-bringup ros-indigo-pepper-sensors-py</li>
</ul>
<p>４．naoqi-driverをソースからインストール</p>
<ul>
<li><code> mkdir -p ~/catkin_ws/src</code></li>
<li><code>cd ~/catkin_ws/src</code></li>
<li><code>git clone https://github.com/ros-naoqi/naoqi_driver.git</code></li>
<li><code>rosdep install -i -y --from-paths ./naoqi_driver</code></li>
<li><code>source /opt/ros/indigo/setup.sh</code></li>
<li><code>cd ../ &amp;&amp; catkin_make</code></li>
</ul>
<p>５．rvizを起動してPepperのセンサ情報を確認</p>
<ul>
<li>roscore</li>
<li>roslaunch pepper_bringup pepper_full_py.launch nao_ip:=192.168.0.2 （このIPは操作するペッパーのものに変更）</li>
<li>rosrun rviz rviz<br />
設定ファイルは以下にあるので利用すると表示されるとあるがうまくいかず、<br />
/opt/ros/indigo/share/pepper_bringup/config/pepper.rviz<br />
「<a href="http://qiita.com/yoneken/items/10341448e1a1f5ba1c5c">PepperをROSと接続する</a>」の設定ファイルを参考にしたが、下のように表示されないので設定を変更した。設定ファイルはここ<a href="http://demura.net/wordpress/wp-content/uploads/2015/08/pepper-rviz.tgz">pepper.rviz</a>。</li>
</ul>
<p><a href="http://demura.net/wordpress/wp-content/uploads/2015/08/pepper-ros.png"><img src="{{ site.baseurl }}/assets/images/2015/08/pepper-ros-1024x752.png" alt="pepper-ros" width="800" height="588" class="aligncenter size-large wp-image-12003" /></a></p>
