---
layout: post
title: Turtlebotでの地図生成・保存、ナビゲーションコマンド
date: 2015-11-22 11:56:35.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- lecture
tags: []
meta:
  _edit_last: '2'
  views: '2930'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/education/lecture/12443.html"
---
<p>TurtlebotでROSのパッケージを使った地図生成・保存・ナビゲーションに関する一連のコマンド。launchファイルで一つにまとめたり、シェルスクリプトで楽もできるがここでは端末ごとにコマンドを実行する。</p>
<p><strong>地図生成・保存<br />
</strong>端末を7個開き、各端末で以下のコマンドを実行する。地図は自動的に保存されないので、<br />
1. $ roslaunch turtlebot_bringup minimal.launch<br />
2. $ rqt -s kobuki_dashboard<br />
3. $ roslaunch turtlebot_bringup 3dsensor.launch<br />
4. $ roslaunch turtlebot_teleop ps3_teleop.launch<br />
5. $ roslaunch turtlebot_navigation gmapping_demo.launch<br />
6. $ roslaunch turtlebot_rviz_launchers view_navigation.launch<br />
7. $ rosrun map_server map_saver -f ~/map/mymap<br />
７番の-f以降は適宜名前を変更する。この例では、ホームディレクトのmapディレクトリにmymap.yamlとmymap.pgmファイルが保存される。yamlが設定ファイル、pgmが画像ファイル。</p>
<p><strong>ウェイポイント・ナビゲ―ション</strong><br />
端末を7個開き、各端末で以下のコマンドを実行する。ウェイポイントナビゲーションはこのウェブサイトのサンプルプログラムを使用する。<br />
1. $ roslaunch turtlebot_bringup minimal.launch<br />
2. $ rqt -s kobuki_dashboard<br />
3. $ roslaunch turtlebot_bringup 3dsensor.launch<br />
4. $ roslaunch turtlebot_navigation amcl_demo.launch map_file:=/home/demulab/map/fmt2.yaml<br />
map_file以降は使いたい地図のyamlファイルを指定する。<br />
5. $ roslaunch turtlebot_rviz_launchers view_navigation.launch --screen<br />
地図上でウェイポイントを知るためには、以下のコマンドを実行し、ウェイポイントに設定したい場所にrvizの[2D Nav Goal]ボタンをクリックするとコマンドを実行している端末に位置と姿勢（クオータニオン）が表示される。<br />
6. $ rostopic echo  /move_base/goal<br />
7. サンプルプログラムを実行<br />
5番の作業で取得したウェイポイントの座標と姿勢をサンプルプログラムのway_pointに設定し、保存する。<br />
(1) C++： <a href="http://demura.net/lecture/12415.html">ここを参照<br />
</a>$ cd ~/catkin_ws<br />
$ catkin_make<br />
$ rosrun wp_navigation wp_navigation<br />
(2) Python:<a href="http://demura.net/lecture/12433.html">ここを参照</a><br />
$ rosrun wp_navigation wp_navigation.py</p>
<p>以上</p>
