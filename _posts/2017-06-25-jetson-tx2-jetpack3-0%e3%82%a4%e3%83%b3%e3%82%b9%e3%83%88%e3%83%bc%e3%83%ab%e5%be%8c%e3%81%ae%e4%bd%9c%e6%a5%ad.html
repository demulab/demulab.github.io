---
layout: post
title: 'JETSON TX2: JETPACK3.0インストール後の作業'
date: 2017-06-25 11:00:54.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- robocup@home
tags: []
meta:
  _edit_last: '2'
  views: '6200'
  classic-editor-remember: classic-editor
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/athome/13407.html"
---
<p>Jetson TX2にJetPack3.0をインストールした後の作業メモ</p>
<ul>
<li>ユーザの作成
<ul>
<li>System Settings -&gt; User Accounts でMy Accountsを作る。この例ではアカウント名をここではhappyminiとする。</li>
<li>/etc/groupのvideoにアカウント名を加える。この例では以下になる。この作業をしないとそのアカウント名でloginできない。
<ul>
<li>video:x:44:ubuntu,nvidia,happymini</li>
</ul>
</li>
<li>新しく作成したアカウントでログインしたら、端末を開き、次のコマンドでnvidiaアカウントの.bashrcをコピーする。
<ul>
<li>cd</li>
<li>cp /home/nvidia/.bashrc .</li>
</ul>
</li>
</ul>
</li>
<li>unityは重いのでxfceを利用する
<ul>
<li>sudo apt-get install xubuntu-desktop</li>
<li>sudo apt-get install xfce4 xfce4-goodies gnome-icon-theme-full</li>
</ul>
</li>
<li>ウェブブラウザのインストール
<ul>
<li>sudo apt-get install chromium-browser</li>
</ul>
</li>
<li>ROSのインストール
<ul>
<li>cd src</li>
<li>git clone https://github.com/jetsonhacks/installROSTX2.git</li>
<li>cd installROSTX2</li>
<li>./installROS</li>
<li>./setupCatkinWorkspace.sh</li>
</ul>
</li>
<li>ROSで使うパッケージのインストール
<ul>
<li>sudo apt install ros-kinetic-rosbridge-suite ros-kinetic-rosapi ros-kinetic-gps-common ros-kinetic-razor-imu-9dof ros-kinetic-robot-pose-ekf ros-kinetic-map-server ros-kinetic-move-base</li>
</ul>
</li>
<li> 温度測定とGUI表示ツールをインストール
<ul>
<li>sudo apt-get install lm-sensors</li>
<li>sudo apt-get install psensor</li>
</ul>
</li>
<li>開発環境のインストール
<ul>
<li>sudo apt-get install python3-setuptools</li>
<li>sudo easy_install3 pip</li>
<li>sudo apt-get install python-dev</li>
<li>sudo apt-get install python3-dev</li>
</ul>
</li>
<li>各種アプリケーションをインストール
<ul>
<li>sudo apt-get install emacs</li>
<li>sudo apt-get install htop</li>
</ul>
</li>
<li>日本語入力
<ul>
<li>日本語を入力するためのmozc関連のarm64用のパッケージがないので以下を参考にソースからビルド、インストールする。
<ul>
<li><a href="http://matoken.org/blog/blog/2017/06/02/ubuntu-16-04-since-there-is-no-mozc-pkg-in-the-aarch64-environment-build-from-source-pkg-to-build/">Ubuntu 16.04 aarch64環境でmozc pkgが無いのでsource pkg</a><a href="http://matoken.org/blog/blog/2017/06/02/ubuntu-16-04-since-there-is-no-mozc-pkg-in-the-aarch64-environment-build-from-source-pkg-to-build/">からbuild</a></li>
</ul>
</li>
</ul>
</li>
<li> tensorflow1.1のインストール
<ul>
<li>この記事「<a href="http://qiita.com/nekomimi/items/81078e0b6097cd4f97e5">Jetson TX2にTensorFlowをインストールした</a>」に従ってインストール</li>
<li>error
<ul>
<li>sudo  pip install ./tensorflow-1.1.0-cp27-cp27mu-linux_aarch64.whl</li>
<li>tensorflow-1.1.0-cp27-cp27mu-linux_aarch64.whl is not a supported wheel on this platform.</li>
<li>https://stackoverflow.com/questions/33622613/tensorflow-installation-error-not-a-supported-wheel-on-this-platform</li>
<li>Download get-pip.py from <a href="https://bootstrap.pypa.io/get-pip.py" rel="nofollow noreferrer">https://bootstrap.pypa.io/get-pip.py</a></li>
<li>sudo python2.7 get-pip.py</li>
<li>sudo pip install tensorflow-1.1.0-cp27-cp27mu-linux_aarch64.whl</li>
</ul>
</li>
</ul>
</li>
<li>Turtlebotパッケージのインストール
<ul>
<li>sudo apt-get install ros-kinetic-kobuki* ros-kinetic-rocon* ros-kinetic-ar*</li>
</ul>
</li>
<li>Kernelとモジュールのビルド
<ul>
<li>Jetson TX2のカーネルではUSBタイプの北陽電機LIDARを認識するために必要なドライバモジュールcdc_acmがない。そのため、Kernelとモジュールをビルドしなければならない。具体的な方法は以下のリンクを参照。
<ul>
<li><a href="https://github.com/waternet/WaternetNautonomous/wiki/Preparing-a-new-Jetson-TX2">Preparing a new Jetson TX2　</a></li>
<li><a href="http://www.jetsonhacks.com/2017/03/25/build-kernel-and-modules-nvidia-jetson-tx2/">Build Kernel and Modules – NVIDIA Jetson TX2</a></li>
</ul>
</li>
</ul>
</li>
<li> OpenCV3.2のビルド
<ul>
<li>JetsonHackの次の記事に従いビルドする。
<ul>
<li><a href="http://www.jetsonhacks.com/2017/04/05/build-opencv-nvidia-jetson-tx2/">Build OpenCV on the NVIDIA Jetson TX2</a></li>
</ul>
</li>
</ul>
</li>
<li> Lidar関連パッケージのインストール
<ul>
<li>sudo apt-get install ros-kinetic-urg-node</li>
</ul>
</li>
<li style="text-align: justify;">Hokuyo Lidar設定:<br />
TurtlebotパッケージではHokuyo Lidar (UTM-30LX)の設定がないので追加する。<br />
/opt/ros/kinetic/share/turtlebot_description/urdf/common_properties.urdf.xacroに以下のコードを一番下の&lt;/robot&gt;の上に追加する。</p>
<pre class="brush:cpp;">&#60;!-- Urg Lidar --&#62;
  &#60;joint name="laser" type="fixed"&#62;
    &#60;origin xyz="0.13 0.00 0.1" rpy="0 0 0" /&#62;
    &#60;parent link="base_link" /&#62;
    &#60;child link="base_laser_link" /&#62;
  &#60;/joint&#62;

  &#60;link name="base_laser_link"&#62;
    &#60;visual&#62;
      &#60;geometry&#62;
        &#60;box size="0.06 0.06 0.07" /&#62;
      &#60;/geometry&#62;
      &#60;material name="Black" /&#62;
    &#60;/visual&#62;
    &#60;inertial&#62;
      &#60;mass value="0.000001" /&#62;
      &#60;origin xyz="0 0 0" /&#62;
      &#60;inertia ixx="0.0001" ixy="0.0" ixz="0.0"
        iyy="0.0001" iyz="0.0"
        izz="0.0001" /&#62;
    &#60;/inertial&#62;
  &#60;/link&#62;</pre>
</li>
<li style="text-align: justify;"> /opt/ros/kinetic/share/turtlebot_bringup/launch/3dsensor.launchの次の部分を変更する。<br />
変更前：</p>
<pre class="brush:cpp;"> &#60;arg name="scan_topic" default="scan"/&#62;</pre>
<p>変更後:</p>
<pre class="brush:cpp;"> &#60;arg name="scan_topic" default="kinect_scan"/&#62;
 &#60;node name="laser_driver" pkg="urg_node" type="urg_node"&#62; &#60;param name="frame_id" value="base_laser_link" /&#62;&#60;/node&#62;</pre>
</li>
<li style="text-align: justify;">/opt/ros/kinetic/share/turtlebot_navigation/param/cosmap_common_params.yamlの31行目のmin_obstacle_heightを0.05,32行目のmax_obstacle_heightを1.2に変更する．Hokuyo Lidarを低い位置に取り付けるため．この設定をしないと障害物回避をしないので悩むことになる．この設定では高さ0.05[m]以上1.2[m]以下の障害物を回避する。それ以外は回避しない。ロボットの高さやセンサの取り付け位置でこの値を変更する。
<pre class="brush:cpp;"> 
 scan:
    data_type: LaserScan
    topic: scan
    marking: true
    clearing: true
    min_obstacle_height: 0.05
    max_obstacle_height: 1.2
</pre>
</li>
<li>doxygenのインストール
<ul>
<li>sudo apt-get install doxygen doxygen-gui</li>
</ul>
</li>
</ul>
