---
layout: post
title: 'Turtlebot3: 4. 動かそう！'
date: 2018-04-01 16:28:03.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- misc
tags: []
meta:
  _edit_last: '2'
  views: '3774'
  _thumbnail_id: '14421'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/misc/14414.html"
---
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/04/burger2.jpg"><img src="{{ site.baseurl }}/assets/images/2018/04/burger2.jpg" alt="" width="960" height="720" class="aligncenter size-full wp-image-14421" /></a></p>
<p>では、Turtlebot3を動かしてみよう！　以下のリモートPC、Raspberry Pi3、OpenCRの設定が終わっているものとします。</p>
<ul>
<li><a href="http://demura.net/misc/14378.html">Turtlebot3: リモートPCの設定</a></li>
<li><a href="http://demura.net/misc/14390.html">Turtlebot3: Raspberry Pi 3の設定</a>r</li>
<li><a href="http://demura.net/">Turtlebot3: OpenCRの設定</a></li>
</ul>
<p><strong>1. リモートPC</strong></p>
<ul>
<li>端末を開き、以下のコマンドを実行する。
<ul>
<li>roscore</li>
</ul>
</li>
</ul>
<p><strong>2. Raspberry Pi3 (Turtlebot 3)</strong></p>
<ul>
<li>端末を開き、次のコマンドを実行する。
<ul>
<li>sudo apt install ros-kinetic-turtlebot3-teleop</li>
<li>roslaunch turtlebot3_bringup turtlebot3_robot.launch</li>
<li>roslaunch turtlebot3_teleop turtlebot3_teleop_key.launch
<ul>
<li>以下のコマンドでTurtlebotを操作できるので思いっきり楽しもう！
<ul>
<li>w/x: 加速/ 減速　並進速度</li>
<li>a/d：加速/ 減速　角速度</li>
<li>スペースキー, s: 停止</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/04/teleop.png"><img src="{{ site.baseurl }}/assets/images/2018/04/teleop.png" alt="" width="737" height="462" class="aligncenter size-full wp-image-14419" /></a></p>
<p>&nbsp;</p>
<ul>
<li>Playstation3 コントローラによるテレオペ
<ul>
<li>次のサイトのSetup for Jessie and Jessie Liteのとおりで動く。
<ul>
<li><a href="https://www.piborg.org/blog/rpi-ps3-help">PlayStation 3 Controller Help Sheet</a></li>
</ul>
</li>
<li>簡単に設定をまとめると次のとおり。
<ul>
<li>sudo apt-get -y install libusb-dev joystick python-pygame</li>
<li>cd src</li>
<li>wget http://www.pabr.org/sixlinux/sixpair.c<br />
gcc -o sixpair sixpair.c -lusb</li>
<li>PS3コントローラをRaspberry Pi3にUSBケーブルで接続する。</li>
<li>リブートする。
<ul>
<li>sudo reboot</li>
</ul>
</li>
<li>cd ~/sec</li>
<li>sudo sixpair</li>
<li>コントローラのUSBケーブルを外す</li>
<li>sudo bluetoothctl</li>
<li>discoverable on</li>
<li>agent on</li>
<li>コントローラのPSボタンを押すとデバイス番号が端末に表示される。例えば、00:06:F7:67:4A:35。</li>
<li>connect  デバイス番号。デバイス番号が00:06:F7:67:4A:35の場合は次のコマンドになる。
<ul>
<li>connect 00:06:F7:67:4A:35</li>
</ul>
</li>
<li>問題がなければtrust デバイス番号。
<ul>
<li>connect 00:06:F7:67:4A:35</li>
</ul>
</li>
<li>succeededと表示されればOK</li>
<li>quit</li>
<li>sudo reboot</li>
</ul>
</li>
<li>ノードを起動
<ul>
<li>roslaunch turtlebot3_bringup turtlebot3_robot.launch</li>
<li>PS3コントローラのUSB端子側に４個のLEDがあり赤く点灯している番号-1がデバイス番号。例えば、2が赤く点灯していると/dev/input/js1になる。デバイス番号のデフォルトがjs0なので1以外の場合は以下のようjoy_devパラメータを指定してコマンドを実行する。</li>
<li>roslaunch teleop_twist_joy teleop.launch joy_dev:=/dev/input/js1</li>
<li>コントローラの１番ボタンを押しながら、左側のジョイスティックを倒すとロボットが移動する。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>終わり</p>
