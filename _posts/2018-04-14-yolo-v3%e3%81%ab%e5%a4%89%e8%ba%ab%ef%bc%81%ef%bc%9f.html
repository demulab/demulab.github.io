---
layout: post
title: YOLO V3に変身！？
date: 2018-04-14 14:45:54.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- misc
tags: []
meta:
  _edit_last: '2'
  views: '2899'
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/misc/14445.html"
---
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/04/yolov3vs2.png"><img src="{{ site.baseurl }}/assets/images/2018/04/yolov3vs2-1024x503.png" alt="" width="800" height="393" class="aligncenter size-large wp-image-14451" /></a></p>
<p>TEDにも登場したリアルタイム物体検出DNN(Deep Neural Network)のYOLOがVersion 3にバージョンアップしYOLO V3に変身したので試したときのメモ。仮面ライダーみたいに大幅にバージョンアップしたのか？</p>
<p>上の例では、処理時間がV２が18.9[ms]、V3が22.7[ms]と多少遅くなっているが、予測確率が80%台から90%台と10%近く向上している。</p>
<ul>
<li>環境
<ul>
<li>CROYDON (BTO組立パソコン)<br />
(CPU: Intel i7-8700K, GPU: Nvidia GTX 1080Ti, Memory:32GB)</li>
<li>Motherboard: ASRock Fatal1ty Z370 Gaming K6</li>
<li>Xubunut16.04.1</li>
<li>Kernel 4.4.0-119-generic</li>
<li>gcc/g++ 5.4.0</li>
</ul>
</li>
<li>Darknetのインストール
<ul>
<li><a href="https://pjreddie.com/darknet/yolo/">この指示にしたがいDarknetをインストールする</a></li>
<li>cd ~/src</li>
<li>git clone https://github.com/pjreddie/darknet.git</li>
<li>cd ~/src/darknet</li>
<li>makefileの該当行を以下に変更
<ul>
<li>GPU=1</li>
<li>CUDNN=1</li>
<li>OPENCV=1</li>
<li>ARCH= -gencode arch=compute_61,code=[sm_61,compute_61]</li>
</ul>
</li>
<li>make -j12</li>
</ul>
</li>
<li>Yolo: Real Time Object Detectionのインストール
<ul>
<li>cd ~/src/darknet</li>
<li>学習済みの重み（パラメータ）ファイルをダウンロード
<ul>
<li>wget http://pjreddie.com/media/files/yolov3.weights</li>
</ul>
</li>
<li>サンプルの実行
<ul>
<li>./darknet detect cfg/yolov3.cfg yolov3.weights data/dog.jpg</li>
</ul>
</li>
</ul>
</li>
<li>実行方法
<ul>
<li>ウェブカメラ
<ul>
<li> ウェブカメラをPCに接続し以下のコマンドを実行</li>
<li>./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights</li>
</ul>
</li>
<li>動画ファイル
<ul>
<li>Webm形式の動画ファイルは問題なく動作する。</li>
<li>./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights &lt;video file&gt;</li>
</ul>
</li>
</ul>
</li>
<li>テスト
<ul>
<li>下図はウェブカメラで本棚を撮ったときの識別結果。私の環境では約30フレーム/秒でリルタイムで識別でき、Cupの識別率は90%後半で安定して検出していた。今まで、YOLOの識別率が悪いので、AlexNetなどと組み合わせて使っていたが、V3なら必要ないかもしれない。いろいろ試してみよう。</li>
</ul>
</li>
</ul>
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/04/yolov3-1.png"><img src="{{ site.baseurl }}/assets/images/2018/04/yolov3-1-1024x752.png" alt="" width="800" height="588" class="aligncenter size-large wp-image-14454" /></a></p>
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/04/yolov3-2.png"><img src="{{ site.baseurl }}/assets/images/2018/04/yolov3-2.png" alt="" width="705" height="426" class="aligncenter size-full wp-image-14455" /></a></p>
<p>以上</p>
