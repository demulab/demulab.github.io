---
layout: post
title: RealSense D435をROSで使う
date: 2018-06-09 20:50:07.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- misc
tags: []
meta:
  the_page_seo_title: ''
  the_page_meta_description: ''
  the_page_meta_keywords: ''
  the_page_noindex: '0'
  the_page_nofollow: '0'
  the_page_canonical_url: ''
  the_page_ads_novisible: '0'
  page_type: default
  _edit_last: '2'
  views: '25766'
  _wp_old_date: '2018-02-01'
  _thumbnail_id: '17107'
  the_page_read_time_novisible: '0'
  the_page_toc_novisible: '0'
  update_level: high
  the_review_enable: '0'
  the_review_type: Product
  the_review_name: ''
  the_review_rate: '5'
  redirect_url: ''
  the_page_no_amp: '0'
  _custom_css: ''
  _custom_js: ''
  the_page_memo: ''
  sns_image_url: ''
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/misc/14263.html"
---
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/02/elephant.png"><img src="{{ site.baseurl }}/assets/images/2018/06/elephant.png" alt="" width="402" height="325" class="aligncenter size-full wp-image-14264" /></a></p>
<p>RealSense D435をROSで使うメモ。RealSense SDKはapt-getでインストールできるのでとても簡単。ROSのラッパーもすでに提供されているのですぐ使える。このメモはカラー画像の表示まで。</p>
<p><strong>ソフトウェア環境</strong></p>
<ul>
<li>Ubuntu16.04</li>
<li>ROS Kinetic</li>
<li>RealSense SDK 2.0: (Build 2.12.0)</li>
<li>ROS Wrapper: build 2.0.3</li>
</ul>
<p><strong>RealSense SDKのインストール</strong></p>
<ul>
<li><a href="https://github.com/IntelRealSense/librealsense/blob/master/doc/distribution_linux.md">このページのとおり実施すればよい。</a>以下の手順はその簡単な日本語訳。</li>
<li>リポジトリにIntelサーバーを追加
<ul>
<li>echo 'deb http://realsense-hw-public.s3.amazonaws.com/Debian/apt-repo xenial main' | sudo tee /etc/apt/sources.list.d/realsense-public.list</li>
</ul>
</li>
<li>サーバーの公開鍵を登録
<ul>
<li>sudo apt-key adv --keyserver keys.gnupg.net --sudo apt-get install librealsense2-dbgrecv-key 6F3EFCDE</li>
</ul>
</li>
<li>リポジトリのリストと使えるパッケージをリフレッシュする
<ul>
<li>sudo apt-get update</li>
</ul>
</li>
<li>デモを実行できるようにインストールする
<ul>
<li>sudo apt-get install librealsense2-dkms</li>
<li>sudo apt-get install librealsense2-utils</li>
</ul>
</li>
<li>開発用に追加のパッケージをインストールする
<ul>
<li>sudo apt-get install librealsense2-dev</li>
<li>sudo apt-get install librealsense2-dbg</li>
</ul>
</li>
<li>リブートする
<ul>
<li>reboot</li>
</ul>
</li>
<li>リブートしたらカーネルがアップデートしているか確認する
<ul>
<li>次のコマンドを実行してrealsenseの文字列があれば成功</li>
<li>modinfo uvcvideo | grep "version:"</li>
</ul>
</li>
</ul>
<p><strong>ROSラッパーのインストール</strong></p>
<ul>
<li><a href="https://github.com/intel-ros/realsense/releases">https://github.com/intel-ros/realsense/releases</a>　からSource code (realsense-2.0.2.tar.gz)を~/catkin_ws/srcにダウンロードする</li>
<li>cd ~/catkin_ws/src</li>
<li>tar xvzf realsense-2.0.3.tar.gz</li>
<li>cd ~/catkin_ws</li>
<li>catkin_make -DCATKIN_ENABLE_TESTING=False -DCMAKE_BUILD_TYPE=Release
<ul>
<li>usr/lib/libusb.aがないと怒られたら、次のコマンドを実施する。
<ul>
<li>sudo apt install libusb-dev</li>
</ul>
</li>
</ul>
</li>
<li>catkin_make install</li>
</ul>
<p><strong>実行</strong></p>
<ul>
<li><code>roslaunch realsense2_camera rs_camera.launch</code>
<ul>
<li>解像度は640x480 pixel。変更したいときはrs_camera.launchの中を書き換える。</li>
</ul>
</li>
<li><code>rosrun image_view image_view  image:=/camera/color/image_raw</code>
<ul>
<li>画像が表示されれば成功。</li>
</ul>
</li>
</ul>
<p><strong>トピック</strong></p>
<p>$ ~/catkin_ws/src/realsense-2.0.2/realsense_ros_camera/launch$ rostopic list<br />
/camera/color/camera_info<br />
/camera/color/image_raw<br />
/camera/color/image_raw/compressed<br />
/camera/color/image_raw/compressed/parameter_descriptions<br />
/camera/color/image_raw/compressed/parameter_updates<br />
/camera/color/image_raw/compressedDepth<br />
/camera/color/image_raw/compressedDepth/parameter_descriptions<br />
/camera/color/image_raw/compressedDepth/parameter_updates<br />
/camera/color/image_raw/theora<br />
/camera/color/image_raw/theora/parameter_descriptions<br />
/camera/color/image_raw/theora/parameter_updates<br />
/camera/depth/camera_info<br />
/camera/depth/image_rect_raw<br />
/camera/depth/image_rect_raw/compressed<br />
/camera/depth/image_rect_raw/compressed/parameter_descriptions<br />
/camera/depth/image_rect_raw/compressed/parameter_updates<br />
/camera/depth/image_rect_raw/compressedDepth<br />
/camera/depth/image_rect_raw/compressedDepth/parameter_descriptions<br />
/camera/depth/image_rect_raw/compressedDepth/parameter_updates<br />
/camera/depth/image_rect_raw/theora<br />
/camera/depth/image_rect_raw/theora/parameter_descriptions<br />
/camera/depth/image_rect_raw/theora/parameter_updates<br />
/camera/extrinsics/depth_to_color<br />
/camera/extrinsics/depth_to_infra1<br />
/camera/extrinsics/depth_to_infra2<br />
/camera/infra1/camera_info<br />
/camera/infra1/image_rect_raw<br />
/camera/infra1/image_rect_raw/compressed<br />
/camera/infra1/image_rect_raw/compressed/parameter_descriptions<br />
/camera/infra1/image_rect_raw/compressed/parameter_updates<br />
/camera/infra1/image_rect_raw/compressedDepth<br />
/camera/infra1/image_rect_raw/compressedDepth/parameter_descriptions<br />
/camera/infra1/image_rect_raw/compressedDepth/parameter_updates<br />
/camera/infra1/image_rect_raw/theora<br />
/camera/infra1/image_rect_raw/theora/parameter_descriptions<br />
/camera/infra1/image_rect_raw/theora/parameter_updates<br />
/camera/infra2/camera_info<br />
/camera/infra2/image_rect_raw<br />
/camera/infra2/image_rect_raw/compressed<br />
/camera/infra2/image_rect_raw/compressed/parameter_descriptions<br />
/camera/infra2/image_rect_raw/compressed/parameter_updates<br />
/camera/infra2/image_rect_raw/compressedDepth<br />
/camera/infra2/image_rect_raw/compressedDepth/parameter_descriptions<br />
/camera/infra2/image_rect_raw/compressedDepth/parameter_updates<br />
/camera/infra2/image_rect_raw/theora<br />
/camera/infra2/image_rect_raw/theora/parameter_descriptions<br />
/camera/infra2/image_rect_raw/theora/parameter_updates<br />
/camera/realsense_ros_camera_manager/bond<br />
/camera/realsense_ros_camera_manager/parameter_descriptions<br />
/camera/realsense_ros_camera_manager/parameter_updates<br />
/rosout<br />
/rosout_agg<br />
/tf_static</p>
<p>以上</p>
