---
layout: post
title: YOLO V3 インストールメモ
date: 2018-07-16 08:15:31.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- robocup@home
tags: []
meta:
  _edit_last: '2'
  views: '4849'
  _thumbnail_id: '14699'
  classic-editor-remember: classic-editor
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/robot/athome/14694.html"
---
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/04/yolov3vs2.png"><img src="{{ site.baseurl }}/assets/images/2018/07/yolov3vs2-1024x503.png" alt="" width="800" height="393" class="aligncenter size-large wp-image-14451" /></a></p>
<p>Alienware 15が修理から戻ってきたので、再インストールしたときのメモ。</p>
<p>上の例では、処理時間がV２が18.9[ms]、V3が22.7[ms]と多少遅くなっているが、予測確率が80%台から90%台と10%近く向上している。</p>
<ul>
<li>環境
<ul>
<li>DELL Alienware 15 R4<br />
(CPU: Intel i7-8750H, Memory:16GB, GPU: Nvidia GTX 1070)</li>
<li>Xubunut16.04.4</li>
<li>Kernel 4.13.0-45-generic</li>
<li>gcc/g++ 5.4.0</li>
</ul>
</li>
<li>Darknetのインストール
<ul>
<li><a href="https://pjreddie.com/darknet/yolo/">この指示にしたがいDarknetをインストールする</a></li>
<li>cd ~/src</li>
<li>git clone https://github.com/pjreddie/darknet.git</li>
<li>cd ~/src/darknet</li>
<li>Makefileの該当行を以下に変更
<ul>
<li>GPU=1</li>
<li>CUDNN=1</li>
<li>OPENCV=1</li>
<li>ARCH= -gencode arch=compute_61,code=[sm_61,compute_61]</li>
</ul>
</li>
<li>make -j 6</li>
</ul>
</li>
<li>Yoloのウェイトのダウンロードと実行
<ul>
<li>cd ~/src/darknet</li>
<li>学習済みのウェイト（パラメータ）ファイルをダウンロード
<ul>
<li>wget http://pjreddie.com/media/files/yolov3.weights</li>
</ul>
</li>
<li>サンプルの実行
<ul>
<li>./darknet detect cfg/yolov3.cfg yolov3.weights data/dog.jpg</li>
</ul>
</li>
</ul>
</li>
<li>実行方法
<ul>
<li>ノートPC内蔵カメラ
<ul>
<li>./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights</li>
</ul>
</li>
<li>動画ファイル
<ul>
<li>Webm形式の動画ファイルは問題なく動作する。</li>
<li>./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights &lt;video file&gt;</li>
</ul>
</li>
</ul>
</li>
<li>テスト
<ul>
<li>下図はノートPC内蔵カメラで壁を撮ったときの識別結果。私の環境では約28フレーム/秒でリルタイムで識別でき、時計の確率は98%、カレンダーに写っている女性はpersonの確率61%で、時々、birdと識別された。</li>
</ul>
</li>
</ul>
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/07/f5f893082b1398fc91084181789f9982.png"><img src="{{ site.baseurl }}/assets/images/2018/07/f5f893082b1398fc91084181789f9982-1024x855.png" alt="" width="800" height="668" class="aligncenter size-large wp-image-14699" /></a></p>
<p><a href="http://demura.net/wordpress/wp-content/uploads/2018/07/bd231f86e393b07555ecbd4942a69f8a.png"><img src="{{ site.baseurl }}/assets/images/2018/07/bd231f86e393b07555ecbd4942a69f8a.png" alt="" width="712" height="552" class="aligncenter size-full wp-image-14700" /></a></p>
<p>以上</p>
