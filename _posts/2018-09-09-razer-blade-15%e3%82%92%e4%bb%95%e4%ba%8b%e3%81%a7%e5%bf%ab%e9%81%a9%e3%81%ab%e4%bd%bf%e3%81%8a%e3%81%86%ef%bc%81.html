---
layout: post
title: Razer Blade 15にVoyager Linuxを入れ仕事で快適に使おう！
date: 2018-09-09 21:06:35.000000000 +09:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- misc
tags: []
meta:
  _edit_last: '2'
  views: '2262'
  _wp_old_date: '2018-08-30'
  _thumbnail_id: '14780'
  _quads_config_visibility: a:0:{}
  the_page_seo_title: ''
  the_page_meta_description: ''
  the_page_meta_keywords: ''
  the_page_noindex: '0'
  the_page_nofollow: '0'
  the_page_canonical_url: ''
  the_page_ads_novisible: '0'
  page_type: default
  the_page_read_time_novisible: '0'
  the_page_toc_novisible: '0'
  update_level: high
  the_review_enable: '0'
  the_review_type: Product
  the_review_name: ''
  the_review_rate: '5'
  redirect_url: ''
  the_page_no_amp: '0'
  _custom_css: ''
  _custom_js: ''
  the_page_memo: ''
  sns_image_url: ''
author:
  login: demu
  email: info@demura.net
  display_name: demu
  first_name: ''
  last_name: ''
permalink: "/misc/14779.html"
---
<p><!-- wp:image {"id":14780} --></p>
<figure class="wp-block-image"><img class="wp-image-14780" src="{{ site.baseurl }}/assets/images/2018/09/voyager2.png" alt="" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>現時点では、15インチのゲーミングノートPCでは世界最小といわれているRazer Blade 15 にLinuxのおしゃれなディストリビューションVoyagerを入れ、仕事で快適に使うために試行錯誤したときのメモ。BIOSを1.05にアップデートするとLinuxでタッチパッドも認識するようになるので、仕事に使うにもほぼ支障はない。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul>
<li><strong>前　提</strong>
<ul>
<li>仕事ではROSやDeep Learningを使うためGPU搭載のノートPCを使う。ただし、事務書類や仕事関係のソフトなどでWindowsも使わざるをえない。</li>
</ul>
</li>
<li><strong>LinuxとWindowsの共存方法</strong>
<ul>
<li>今までデュアルブートでLinuxとWindowsを別々に起動していたが、切り替えに時間がかかり、作業が中断し、ハードディスクの使用に無駄がでるなどの問題点をかかえていた。そこで、今回は、Linuxに仮想マシンをインストールし、そこにWindows10を入れることにした。</li>
</ul>
</li>
<li><strong>Linuxはどのディストリビューションにするか</strong>
<ul>
<li>仕事関係でUbuntu系を使わなければならない。Ubuntu系もいろいろあるが、軽量のデスクトップXfceを使ったXubuntuにする。ただし、Xubutuのデスクトップデザインは洗練されていない。しかも、Xubuntuのマスコットはねずみ、Razerのロゴはヘビなので似合わない。調べてみると、フランス製のVoyagerがエレガントで美しいデザインなので採用してみることにした。</li>
</ul>
</li>
<li> <strong>環　境</strong>
<ul>
<li>Razer Blade 15<br />(CPU: Intel i7-8750H, Memory:16GB, GPU: Nvidia 1070 Max-Q Design, Memory: 8GB)</li>
<li>Linux
<ul>
<li>Voyager 16.04.3</li>
<li>Kernel 4.15.0-33-generic</li>
<li>gcc/g++ 5.4.0</li>
</ul>
</li>
<li>仮想マシン
<ul>
<li>VMWare</li>
<li>ホストOS: Voyager 16.04.3</li>
<li>ゲストOS: Windows10 </li>
</ul>
</li>
</ul>
</li>
<li><strong>周辺機器</strong>
<ul>
<li>プータブルDVDドライブ：ドライブ類は内蔵されていないのでインストールなどに１台あると便利。私は以下の機器を利用した。
<ul>
<li><a href="https://amzn.to/2LNROPc">I-O DATA ポータブルDVDドライブ DVRP-UT8C2W </a></li>
</ul>
</li>
<li>USB LANアダプタ (ドライバを入れずともUbuntu16.04ですぐ認識するので便利）。Razer Blade 15には有線LANのコネクタがないので、USB LANアダプタは必要。
<ul>
<li><a href="https://amzn.to/2LIny8l"> 有線LANアダプター LUA4-U3-AGT Giga USB3.0</a></li>
</ul>
</li>
<li>電源アダプタ：GPU 1070搭載機は230W、1060は200Wの電源アダプタが必要。RAZER Bladeはコンパクトなのに電源アダプタが大きのは残念。
<ul>
<li><a href="https://www2.razer.com/jp-jp/store/razer-230w-power-adapter">RAZER 230W Power Adaptor</a></li>
<li><a href="https://www2.razer.com/jp-jp/store/razer-200w-power-adapter">RAZER 200W Power Adaptor</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:image {"id":14789} --></p>
<figure class="wp-block-image"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:list --></p>
<ul>
<li><strong>BIOSアップデート</strong>
<ul>
<li> BIOSのバージョンが1.03だとLinuxでタッチパッドを認識しないので次の方法で1.05にアップデートする。</li>
<li><a href="https://support.razer.com/gaming-laptops/razer-blade-15-2018/">RAZER  15” (2018) SUPPORT</a>のSoftware &amp; Driversをクリック</li>
<li><a href="http://drivers.razersupport.com//index.php?_m=downloads&amp;_a=downloadfile&amp;downloaditemid=2923">[Blade 15" 2018] BIOS Updater Guide 1.05のDownload</a>をクリックしダウンロードし、その説明に従いBIOSをアップデートする。</li>
</ul>
</li>
<li><strong>Voyager Linuxのインストール</strong>
<ul>
<li>ディスプレイ、無線LAN、スピーカー、マイク、内蔵カメラは問題なく動く。</li>
<li>GPUはこのページの後で説明している方法でNVIDIAのドライバを入れればあっさり認識され使える。</li>
<li>タッチパッドはBIOSを1.05にアップデートしていたらLinuxでも認識する。</li>
<li>Voyager Linuxは基本的にはXubuntuなのでインストール方法は同じ。<a href="http://demura.net/misc/14766.html">この記事を参照にインストールしてみてください。</a>
<ul>
<li><a href="http://demura.net/misc/14725.html">GPUの設定に関してはこの記事を参考にしてください。</a></li>
</ul>
</li>
</ul>
</li>
<li><strong>すぐ必要なソフトのインストール</strong>
<ul>
<li>sudo apt install git  emacs </li>
</ul>
</li>
<li><strong>設　定</strong>
<ul>
<li>ショートカットキー
<ul>
<li>emacs派の僕にとっては、Ctrl-Xで仮想画面に切り替われては仕事にならないので以下のように変更した。これにより少し幸せになれた。
<ul>
<li>設定-&gt;キーボード-&gt;アプリケーションショートカットキーでショートカットがCtrl+xになっているコマンドxfdashboardをRemove(削除)する。</li>
</ul>
</li>
</ul>
</li>
<li>CAPS LOCKとCTRLキーの入れ替える
<ul>
<li>/etc/default/keyboardのXKBOPTIONS="ctrl:nocaps"と変更する。</li>
</ul>
</li>
<li>日本語化
<ul>
<li><a href="http://superjeter007.blog.jp/archives/23691636.html">このウェブサイトに従って日本語化した。</a>以下はその要約。
<ul>
<li>設定-&gt;言語サポート</li>
<li>「言語サポートが完全にはインストールされていません」と表示されるので、[インストール]をクリック</li>
</ul>
</li>
<li>Conkyの文字化けを直す
<ul>
<li>日本語フォントを設定して日本語化もできるが、デザイン的に英語が合うので、英語で表示する。<br /><a href="https://qiita.com/AmGacrux/items/b5bef6646a2576e577bc">この記事のとおり実施</a><br />メニュー-&gt;設定-&gt;セッションと起動-&gt;自動開始アプリケーションのConky Controlにチェックが入っていなければ入れ、選択してEditをクリックする。コマンドに以下を入れる。つまり、言語環境を英語にする。<br />sh -c “sleep 5;LC_ALL=C sh ~/.scripts/Conky/DemConky.sh;”</li>
</ul>
</li>
</ul>
</li>
<li> ホームディレクトリにある日本語ファイル名を英語に変換
<ul>
<li>次のコマンドを端末で実行
<ul>
<li><code>LANG=C xdg-user-dirs-gtk-update</code></li>
</ul>
</li>
<li>ウインドウが開くので右下の[Update Names]をクリックして変更し、再起動する。</li>
<li>再起動するとBluetooh関連のBluemanが"/home/ユーザー名/ダウンロード"というディレクトリがないとエラーを吐くので次のコマンドでBlueman mangerを起動する。
<ul>
<li><code>sudo blueman-manager</code></li>
</ul>
</li>
<li>表示-&gt;ローカルサービス-&gt;転送-&gt;転送設定のIncoming FolderでDownloadsを選び、Applyをクリックし、closeをクリックしウインドウを閉じる。</li>
</ul>
</li>
<li>タッチパッドの設定<br /> <a href="http://demura.net/wordpress/wp-content/uploads/2018/08/touchpad-2.png"><img class="aligncenter size-full wp-image-14792" src="{{ site.baseurl }}/assets/images/2018/09/touchpad-2.png" alt="" width="454" height="492" /></a>
<ul>
<li>BIOSを1.05にアップデートしないと有効にならない。</li>
<li>設定-&gt;マウスとタッチパッド-&gt;デバイス：1A573 820000:00 06CB:CD73 Touchpadを選択する。</li>
<li>「このデバイスを有効にする」にチェックを入れる。</li>
<li>タッチパッドのタブをクリックし、「タイプ中はタッチパッドを無効にする」にチェックを入れる。</li>
</ul>
</li>
<li>ログイン画面に写真を入れる
<ul>
<li>入れたい写真の画像ファイルを~/.faceにコピーする。これだけ。</li>
</ul>
</li>
<li>デスクトップフォントのサイズ変更。標準のフォントサイズは9ptで、中高年には小さすぎるので10ptに変更する。あるいは、DPIの値を変更する。
<ul>
<li>設定-&gt;外観-&gt;フォント(F)のデフォルトフォントのサイズを10に変更</li>
<li>設定-&gt;外観-&gt;フォント(F)のDPIが96になっているので、それを例えば100などに変更する。</li>
</ul>
</li>
</ul>
</li>
<li> <strong>NVIDIAドライバのインストール</strong>
<ul>
<li>準備 （これをやらないとハマります）
<ul>
<li>NVIDIAのドライバをインストールしていないので、起動するとIntelのGPUでXが起動する。Ctlr+Alt+F1でXを落とす</li>
<li>sudo apt update</li>
<li>sudo apt upgrade</li>
<li>sudo service lightdm stop</li>
</ul>
</li>
<li> インストール
<ul>
<li>sudo add-apt-repository ppa:graphics-drivers/ppa</li>
<li>sudo apt update</li>
<li>sudo apt install nvidia-390  nvidia-settings</li>
<li>sudo reboot</li>
</ul>
</li>
</ul>
</li>
<li><strong> ソフトウェアのインストール</strong>
<ul>
<li>エディタ等
<ul>
<li>sudo apt install  git emacs curl aptitude</li>
</ul>
</li>
<li>MS Office互換ソフト：WPS Office
<ul>
<li><a href="https://qiita.com/Kogia_sima/items/da3f3292abbee0f30782">ここを参考にした</a></li>
</ul>
</li>
<li>VMware
<ul>
<li><a href="https://docs.vmware.com/jp/VMware-Workstation-Player-for-Linux/14.0/workstation-player-14-linux-user-guide.pdf">ここを参考にした</a></li>
</ul>
</li>
<li>省電力 (バッテリ持ちが格段によくなる）
<ul>
<li>sudo add-apt-repository ppa:nilarimogard/webupd8</li>
<li>sudo apt -y install tlp tlp-rdw powertop</li>
<li>sudo tlp start</li>
<li>sudo systemctl start tlp</li>
<li>sudo systemctl enable tlp</li>
</ul>
</li>
<li>上の方法でもバッテリ持ちはよくなるが、出張などで更にバッテリ持ちを良くしなければいけない状況に陥った時は、GPUをNVIDIAからIntelに変更する。もちろん、NVIDIAのGPUを使えないので深層学習のアプリケーションなどは遅くて使えない。
<ul>
<li>使用しているGPUを調べるコマンド
<ul>
<li>prime-select query</li>
</ul>
</li>
<li>Intelに変更するコマンド
<ul>
<li>sudo prime-select intel</li>
<li>sudo reboot</li>
</ul>
</li>
<li>Nvidiaに変更するコマンド
<ul>
<li>sudo prime-select nvidia</li>
<li>sudo reboot</li>
</ul>
</li>
</ul>
</li>
<li>Cuda9.2のインストール (<a href="https://developer.nvidia.com/cuda-downloads">NVIDIAのウェブサイト</a>から)
<ul>
<li>Linux-&gt;x86_64-&gt;ubuntu-&gt;16.04-&gt;dev(local)を選択</li>
<li>Download (1.2GB)をクリックし、ダウンドードが完了するまで待つ。</li>
<li>sudo dpkg -i cuda-repo-ubuntu1604-9-2-local_9.2.148-1_amd64.deb</li>
<li>sudo apt-key add /var/cuda-repo-9-2-local/7fa2af80.pub</li>
<li>sudo apt-get update</li>
<li>sudo apt-get install cuda</li>
<li>.bashrcに以下を追加し、CUDAのパスを通す
<ul>
<li><code>export PATH=/usr/local/cuda-9.2/bin${PATH:+:${PATH}}</code></li>
</ul>
</li>
</ul>
</li>
<li>cuDNNのインストール( <a href="https://developer.nvidia.com/cudnn">NVIDIAのウェブ</a>から)
<ul>
<li>nvidiaのdeveloperに登録しないとダウンロードできないので登録する。</li>
<li>Download cuDNN v7.2.1 for CUDA9.2をクリック</li>
<li>cuDNN v7.1.4 for Runtime Library for Ubuntu16.04 (Deb)とcuDNN v7.1.4 Developer Library for Ubuntu16.04 (Deb)をダウンロードする。</li>
<li><code>sudo dpkg -i libcudnn7_7.2.1.38-1+cuda9.2_amd64.deb</code></li>
<li><code>sudo dpkg -i libcudnn7-dev_7.2.1.38-1+cuda9.2_amd64.deb</code></li>
</ul>
</li>
<li><a href="http://demura.net/misc/14118.html">OpenCV3.4.0のインストール</a></li>
<li><a href="http://demura.net/lecture/13657.html">ROS Kineticのインストール</a></li>
<li><a href="http://demura.net/athome/14694.html">YOLO V3のインストール</a></li>
</ul>
</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>終わり</p>
<p><!-- /wp:paragraph --></p>
